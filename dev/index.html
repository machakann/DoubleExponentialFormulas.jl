<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · DoubleExponentialFormulas.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">DoubleExponentialFormulas.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Theory"><span>Theory</span></a></li><li><a class="tocitem" href="#Instllation"><span>Instllation</span></a></li><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li></ul></li><li><a class="tocitem" href="reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/machakann/DoubleExponentialFormulas.jl/blob/master/docs/src/index.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="DoubleExponentialFormulas.jl"><a class="docs-heading-anchor" href="#DoubleExponentialFormulas.jl">DoubleExponentialFormulas.jl</a><a id="DoubleExponentialFormulas.jl-1"></a><a class="docs-heading-anchor-permalink" href="#DoubleExponentialFormulas.jl" title="Permalink"></a></h1><p>This package provides functions for one-dimensional numerical integration using the double exponential formula <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup><sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> also known as the <a href="https://en.wikipedia.org/wiki/Tanh-sinh_quadrature">tanh-sinh quadrature</a> and its variants.</p><h2 id="Theory"><a class="docs-heading-anchor" href="#Theory">Theory</a><a id="Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Theory" title="Permalink"></a></h2><p>The double exponential formulas transform an integrand into another form well-suited to the trapezoidal rule. For example, the tanh-sinh quadrature converts an integration of <span>$f(x)$</span> on <span>$x$</span> over <span>$[-1, 1]$</span> into an equivalent integration on <span>$t$</span> over <span>$[-∞, ∞]$</span>,</p><p class="math-container">\[\int_{-1}^{1} f(x) dx = \int_{-\infty}^{\infty} f\left(x(t)\right) \frac{dx}{dt} dt = \int_{-\infty}^{\infty} f\left(x(t)\right)w(t) dt\]</p><p>where</p><p class="math-container">\[x(t) = \tanh \left( \frac{π}{2} \sinh t \right) \\
w(t) = \frac{\frac{π}{2} \cosh t}{\cosh^{2}\left(\frac{π}{2} \sinh t \right)}.\]</p><p>Since <span>$f\left(x(t)\right)w(t)$</span> rapidly decays with <span>$|t|$</span> increasing, the transformed integral is highly insensitive to both edges of the integral interval. Therefore, the infinite interval can be cut off at a certain (finite) point, and the numerical integration just works even if the integrand <span>$f(x)$</span> has singularity or discontinuity at the endpoints. For instance, generally, it is difficult to estimate the following integral because of the singularity at the endpoints.</p><p class="math-container">\[\int_{-1}^{1} f(x) dx = \int_{-1}^{1} \frac{dx}{(2-x)(1-x)^{1/4}(1+x)^{3/4}}\]</p><p>However, the transformed integrand <span>$f\left(x(t)\right)w(t)$</span> quickly drops and almost vanishes at <span>$|t| \approx 4$</span>. The endpoint singularity has gone, and the range <span>$|t| &gt; 4$</span> doesn&#39;t have any significant contribution.</p><p><img src="https://imgur.com/0hJKg50.png" alt="Change of variable"/></p><p>This transformation accelerates the convergence and enhances the accuracy in a numerical integration; typically, the trapezoidal rule is used. The last integral is approximated to a weighted sum with a step size <span>$h$</span>,</p><p class="math-container">\[\int_{-\infty}^{\infty} f\left(x(t)\right)w(t) dt \approx h\sum_{k = -\infty}^{\infty} f(x_k)w_k\]</p><p>where <span>$x_k = x(kh)$</span> and <span>$w_k = w(kh)$</span>. The infinite summation is terminated if <span>$f(x_k)w_k$</span> gets small enough.</p><p>Another point is that the <span>$x_k$</span> and <span>$w_k$</span> is independent of integrands. Therefore, the table of these numbers can be pre-calculated and is re-usable. This mechanism significantly cut down the computational time.</p><h3 id="Tanh-sinh-quadrature"><a class="docs-heading-anchor" href="#Tanh-sinh-quadrature">Tanh-sinh quadrature</a><a id="Tanh-sinh-quadrature-1"></a><a class="docs-heading-anchor-permalink" href="#Tanh-sinh-quadrature" title="Permalink"></a></h3><p>The tanh-sinh quadrature covers the numerical integrations over the range <span>$[-1, 1]$</span> using the following abscissas and weights.</p><p class="math-container">\[x(t) = \tanh \left( \frac{π}{2} \sinh t \right) \\
w(t) = \frac{\frac{π}{2} \cosh t}{\cosh^{2}\left(\frac{π}{2} \sinh t \right)}\]</p><p>Furthermore, the additional change of variables extends to the integration with arbitrary finite intervals <span>$[a, b]$</span>.</p><p class="math-container">\[x(u) = \frac{b + a}{2} + \frac{b - a}{2}u\]</p><p>The <span>$x(u)$</span> changes from <span>$a$</span> to <span>$b$</span> when <span>$u$</span> changes from <span>$-1$</span> to <span>$1$</span>. Hence,</p><p class="math-container">\[\int_{a}^{b} f(x) dx = \frac{b - a}{2} \int_{-1}^{1} f\left(x(u)\right) du = \frac{b - a}{2} \int_{-\infty}^{\infty} f\left(x\left(u(t)\right)\right)w(t) dt.\]</p><h3 id="Exp-sinh-quadrature"><a class="docs-heading-anchor" href="#Exp-sinh-quadrature">Exp-sinh quadrature</a><a id="Exp-sinh-quadrature-1"></a><a class="docs-heading-anchor-permalink" href="#Exp-sinh-quadrature" title="Permalink"></a></h3><p>The exp-sinh quadrature is available for the numerical integration over the half-infinite interval <span>$[0, \infty)$</span>.</p><p class="math-container">\[x(t) = \exp \left( \frac{π}{2} \sinh t \right) \\
w(t) = \frac{π}{2} \cosh t \exp\left(\frac{π}{2} \sinh t \right)\]</p><p>Finite shift of the integral interval <span>$x(u) = u + a$</span> immediately enables integrating over <span>$[a, \infty)$</span>.</p><p class="math-container">\[\int_{a}^{\infty} f(x) dx = \int_{0}^{\infty} f\left(x(u)\right) du = \int_{-\infty}^{\infty} f\left(x\left(u(t)\right)\right)w(t) dt\]</p><p>Similarly, reversing the abscissas around the origin <span>$x(u) = -u$</span> converts the integration on <span>$x$</span> over <span>$(-\infty, b]$</span> into an equivalent integral on <span>$u$</span> over <span>$[-b, \infty)$</span>.</p><p class="math-container">\[\int_{-\infty}^{b} f(x) dx = \int_{-b}^{\infty} f\left(x(u)\right) du\]</p><p>Note that <span>$\int_{a}^{b} f(x) dx = -\int_{b}^{a} f(x) dx$</span>. In conclusion, the exp-sinh quadrature covers arbitrary half-infinite integral intervals, <span>$[a, \infty)$</span> and <span>$(-\infty, b]$</span>.</p><h3 id="Sinh-sinh-quadrature"><a class="docs-heading-anchor" href="#Sinh-sinh-quadrature">Sinh-sinh quadrature</a><a id="Sinh-sinh-quadrature-1"></a><a class="docs-heading-anchor-permalink" href="#Sinh-sinh-quadrature" title="Permalink"></a></h3><p>The sinh-sinh quadrature covers the infinite integral interval <span>$(-\infty, \infty)$</span>.</p><p class="math-container">\[x(t) = \sinh \left( \frac{π}{2} \sinh t \right) \\
w(t) = \frac{π}{2} \cosh t \cosh\left(\frac{π}{2} \sinh t \right)\]</p><p>The transformation doesn&#39;t change the interval. However, <span>$f\left(x(t)\right)w(t)$</span> decays quickly in the <span>$t$</span> space, as far as the integral isn&#39;t divergent, to make the numerical integration quite efficient.</p><p class="math-container">\[\int_{-\infty}^{\infty} f(x) dx = \int_{-\infty}^{\infty} f\left(x(t)\right)w(t) dt\]</p><h2 id="Instllation"><a class="docs-heading-anchor" href="#Instllation">Instllation</a><a id="Instllation-1"></a><a class="docs-heading-anchor-permalink" href="#Instllation" title="Permalink"></a></h2><p>Press <code>]</code> on a Julia REPL to enter the Pkg mode, and run the following command.</p><pre><code class="language-none">add https://github.com/machakann/DoubleExponentialFormulas.jl.git</code></pre><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><h3 id="Handy-interface-with-Float64-precision"><a class="docs-heading-anchor" href="#Handy-interface-with-Float64-precision">Handy interface with Float64 precision</a><a id="Handy-interface-with-Float64-precision-1"></a><a class="docs-heading-anchor-permalink" href="#Handy-interface-with-Float64-precision" title="Permalink"></a></h3><pre><code class="language-none">    I, E = quadde(f::Function, a::Real, b::Real, c::Real...;
                  atol::Real=zero(Float64),
                  rtol::Real=atol&gt;0 ? zero(Float64) : sqrt(eps(Float64)))</code></pre><p>The <code>quadde</code> function provides a handy way to integrate a function <span>$f(x)$</span> in an arbitrary interval.</p><pre><code class="language-julia">using DoubleExponentialFormulas
using LinearAlgebra: norm

f(x) = 1/(1 + x^2)
I, E = quadde(f, -1, 1)

I ≈ π/2                   # true
E ≤ sqrt(eps(I))*norm(I)  # true</code></pre><p>The above example computes <span>$\int_{-1}^{1} \frac{1}{1 + x^2} dx$</span>. The <code>I</code> is the obtained integral value and the <code>E</code> is an estimated numerical error. The <code>E</code> is not exactly equal to the difference from the true value. However, one can expect that the integral value <code>I</code> is converged if <code>E &lt;= max(atol, rtol*norm(I))</code> is true. Otherwise, the obtained <code>I</code> would be unreliable; the number of repetitions exceeds the <code>maxlevel</code> before converged.</p><p>Half-infinite intervals, <span>$[a, \infty)$</span> and <span>$(-\infty, b]$</span>, and the infinite interval, <span>$(\infty, -\infty)$</span>, are also valid as far as the integral is convergent.</p><pre><code class="language-julia"># Computes ∫ 1/(1+x^2) dx in [0, ∞)
I, E = quadde(x -&gt; 1/(1 + x^2), 0, Inf)
I ≈ π/2    # true

# Computes ∫ 1/(1+x^2) dx in (-∞, ∞)
I, E = quadde(x -&gt; 1/(1 + x^2), -Inf, Inf)
I ≈ π      # true</code></pre><p><img src="https://imgur.com/id5rPIP.png" alt="Fig.1-3"/></p><p>Optionally, one can subdivide the integral interval [a, b, c, ...], which returns <span>$\int_a^b f(x) dx + \int_b^c f(x) dx + \cdots$</span>.  It is worth noting that discontinuity or singularity is allowed at the endpoints.</p><pre><code class="language-julia"># Computes ∫ 1/sqrt(|x|) dx in (-∞, ∞)
# The integrand has a singular point at x = 0
I, E = quadde(x -&gt; 1/sqrt(abs(x)), -1, 0, 1)
I ≈ 4    # true</code></pre><p><img src="https://imgur.com/ckPlHsi.png" alt="Fig.4"/></p><h3 id="Optimized-numerical-integrators"><a class="docs-heading-anchor" href="#Optimized-numerical-integrators">Optimized numerical integrators</a><a id="Optimized-numerical-integrators-1"></a><a class="docs-heading-anchor-permalink" href="#Optimized-numerical-integrators" title="Permalink"></a></h3><p>The type <code>QuadDE</code> represents the pre-calculated table of <span>$x_k$</span> and <span>$w_k$</span>. If one needs an optimized table, for example with a smaller step size <span>$h$</span> or with a better precision using <code>BigFloat</code>, <code>QuadDE</code> will provides the functionality.</p><pre><code class="language-none">qde = QuadDE(BigFloat; h0=one(BigFloat), maxlevel=12)
qde(x -&gt; 2/(1 + x^2), -1,  1)</code></pre><p>User can specify the required precision as a type (<code>T&lt;:AbstractFloat</code>), the starting step size <code>h0</code> and the maximum number of repetition <code>maxlevel</code>. The <code>h0</code> and <code>maxlevel</code> shown above are the default values, so it can be omitted. <code>QuadDE</code> instance is an callable object which has the same interface of <code>quadde</code>, actually <code>quadde</code> is an alias to <code>QuadDE(Float64)(...)</code> with a pre-calculated instance.</p><p><code>QuadTS</code> tries to calculate integral values <code>maxlevel</code> times at a maximum; the step size of a trapezoid is started from <code>h0</code> and is halved in each following repetition for finer accuracy. The repetition is terminated when the difference from the previous estimation gets smaller than a certain threshold.  The threshold is determined by the runtime parameters, <code>atol</code> or <code>rtol</code>.</p><p>Using smaller <code>h0</code> may help if the integrand <code>f(x)</code> includes fine structure, such as spikes, in the integral interval. However, the subdivision of the interval would be more effective in many cases. Try subdivision first, and then think of an optimized integrator.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Takahasi, H.; Mori, M. Double Exponential Formulas for Numerical Integration. <em>Publ. Res. Inst. Math. Sci.</em> <strong>1973,</strong> <em>9 (3),</em> 721–741.  <a href="https://doi.org/10.2977/prims/1195192451">10.2977/prims/1195192451</a>.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Mori, M.; Sugihara, M. The Double-Exponential Transformation in Numerical Analysis. <em>J. Comput. Appl. Math.</em> <strong>2001,</strong> <em>127 (1–2),</em> 287–296.  <a href="https://doi.org/10.1016/S0377-0427(00)00501-X">10.1016/S0377-0427(00)00501-X</a>.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 31 March 2021 11:49">Wednesday 31 March 2021</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
